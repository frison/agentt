---
description: Guidelines for preserving git history in recipes and operations
globs: []
alwaysApply: false
---

# Git History Preservation Guidelines

## Prerequisites
- Git installed and configured
- Basic understanding of Git operations
- Access to target repositories

## Core Principles
- Preserve source repository information
- Use consistent naming conventions
- Only use the "my-gift-to-ai" branch - this represents permission to use code
- Create clean imports without git history metadata
- Maintain provenance information in commit messages
- **ALWAYS operate from project root** unless explicitly stated otherwise

## Critical Elements
- **SOURCE_URL**: URL provided by human - source repository location
- **REPO_NAME**: Name of the repository being imported
- **SHA**: Commit hash for reference

## Required Import Process
1. Start from project root and create provenance directory (CRITICAL - all paths relative to project root):
   ```bash
   cd "$(git rev-parse --show-toplevel)"  # Ensure we're at project root
   mkdir -p .cursor/tmp/provenance
   cd .cursor/tmp/provenance
   git clone --branch my-gift-to-ai {SOURCE_URL}
   ```

2. Create tar archive for provenance preservation (from provenance directory):
   ```bash
   tar -czf {repo-name}.tar.gz {repo-name}
   ```

3. Get the commit SHA for reference (paths relative to current provenance directory):
   ```bash
   cd {repo-name}
   SHA=$(git rev-parse HEAD)
   cd ../..  # Return to project root
   ```

4. Extract repository content to destination without git history (from project root):
   ```bash
   mkdir -p {destination}
   tar -xzf .cursor/tmp/provenance/{repo-name}.tar.gz -C {destination} --strip-components=1
   cd {destination}
   rm -rf .git  # Remove git metadata
   ```

5. Add to version control with provenance information (from destination directory):
   ```bash
   cd "$(git rev-parse --show-toplevel)"  # Return to project root
   git add {destination}/
   git commit -m "Import {source} from {SOURCE_URL} (SHA: $SHA)"
   ```

6. Clean up (from project root):
   ```bash
   rm -rf .cursor/tmp/provenance
   ```

## Common Mistakes
- Using git operations that preserve history metadata
- Not capturing the commit SHA for reference
- Using incorrect URL from what human provided
- Not using the "my-gift-to-ai" branch
- Modifying the URL format provided by the human
- Not cleaning up temporary files
- Preserving .git metadata in the destination
- Not following the exact sequence of steps
- Not maintaining clear directory context
- Running commands from incorrect directory
- Using relative paths without clear context